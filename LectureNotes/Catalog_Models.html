<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-02-02 Wed 21:14 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>A catalog of Models in R</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="daniel b" />
<style type="text/css"> tr:nth-child(odd) {background-color: #e2e2e2;}  tr:first-child {font-weight: bold}  tr:hover {background-color: #d0c6e5;}</style>
<style>
/* Daniel Ballesteros-Chavez */
/* DBCh CSS for blog project */
/* color schemes: #333745; #E63462 ; #C7EFCF ; #EEF5DB ; #909396; #262626;*/
/* Modified version with responsive TOC
/* usage: #+HTML_HEAD: <link rel="stylesheet" type="text/css" href="./style01.css"/> */
body {
font-size: 18px;
color: #404040;
/* background-color: #333745; */
font-family: Helvetica;
line-height: 1.3;
}
#content {
max-width: 50em;
margin-left: auto;
margin-right: auto;
}
p {
text-align: justify;
}
/* this part is about the table of contents TOC */
#table-of-contents a:link,
#table-of-contents a:visited {
color: #404040;
background: transparent;
}
#table-of-contents a:hover {
background-color: #ccc;
color: #404040;
}
#table-of-contents {
line-height: 1.2;
}
#table-of-contents h2 {
background-color:  #ccc ;
padding-left: 0.3em;
color: #404040;
border-bottom: 0;
}
#table-of-contents ul {
list-style: none;
padding-left: 0.3em;
font-weight: normal;
}
#table-of-contents div>ul>li {
margin-top: 1em;
font-weight: bold;
}
#table-of-contents .tag {
display: none;
}
#table-of-contents .todo,
#table-of-contents .done {
font-size: 80%;
}
#table-of-contents ol>li {
margin-top: 1em;
}
@media screen {
#table-of-contents {
position: fixed;
top: 0;
left: 0;
padding: 1em 0 1em 1em;
width: 290px;
height: 100vh;
overlow-x: hidden;
overlow-y: auto;
overflow: auto;
}
#table-of-contents h2 {
margin-top: 0;
font-family: Helvetica,Arial,"Lucida Grande",sans-serif;
}
#table-of-contents code {
font-size: 12px;
}
}
@media screen and (max-width: 95em) {
#table-of-contents {
display: none;
}
h1.title {
margin-left: 0%;
}
div#content {
margin-left: 5%;
max-width: 90%;
}
}
/*Html Boxes around THMs and Propositions */
.abstract  {
color:  #404040;
border: 1px solid #404040;
box-shadow: 3px 3px 3px ;
padding: 8pt;
overflow: auto;
margin: 1.2em;
position: relative;
overflow: auto;
padding-top: 1.2em;
}
.abstract:before {
display: inline;
position: absolute;
background-color: white;
top: -5px;
left: 10px;
padding: 3px;
border: 1px solid black;
content: 'Abstract';
}
.mydef  {
color:  #404040;
border: 1px solid #404040;
background-color: #FFD580;
/* box-shadow: 3px 3px 3px orange; */
padding: 8pt;
overflow: auto;
margin: 1.2em;
position: relative;
overflow: auto;
padding-top: 1.2em;
}
.mydef:before {
display: inline;
position: absolute;
/* background-color: white; */
background-color: orange;
top: -5px;
left: 10px;
padding: 3px;
border: 1px solid black;
content: 'Definition';
}
.prop  {
color:  #404040;
border: 1px solid ;
background-color: #F1FFC2;
/* box-shadow: 3px 3px 3px green; */
padding: 8pt;
overflow: auto;
margin: 1.2em;
position: relative;
overflow: auto;
padding-top: 1.2em;
}
.prop:before {
color:  white;
display: inline;
position: absolute;
background-color: green;
top: -5px;
left: 10px;
padding: 3px;
border: 1px solid black;
content: 'Proposition';
}
.thm  {
color:  #404040;
border: 1px solid ;
background-color: lightcyan;
/* box-shadow: 3px 3px 3px brown; */
padding: 8pt;
overflow: auto;
margin: 1.2em;
position: relative;
overflow: auto;
padding-top: 1.2em;
}
.thm:before {
color:  white;
display: inline;
position: absolute;
background-color: darkblue;
top: -5px;
left: 10px;
padding: 3px;
border: 1px solid black;
content: 'Theorem';
}
.cor  {
color:  #404040;
border: 1px solid blue;
box-shadow: 3px 3px 3px blue;
padding: 8pt;
overflow: auto;
margin: 1.2em;
position: relative;
overflow: auto;
padding-top: 1.2em;
}
.cor:before {
display: inline;
position: absolute;
background-color: white;
top: -5px;
left: 10px;
padding: 3px;
border: 1px solid black;
content: 'Corollary';
}
/*defaults form org-mode export */
.title  { text-align: center; }
.todo   { font-family: monospace; color: red; }
.done   { color: green; }
.tag    { background-color: #eee; font-family: monospace;
padding: 2px; font-size: 80%; font-weight: normal; }
.timestamp { color: #bebebe; }
.timestamp-kwd { color: #5f9ea0; }
.right  { margin-left: auto; margin-right: 0px;  text-align: right; }
.left   { margin-left: 0px;  margin-right: auto; text-align: left; }
.center { margin-left: auto; margin-right: auto; text-align: center; }
.underline { text-decoration: underline; }
#postamble p, #preamble p { font-size: 90%; margin: .2em; text-align: center;}
p.verse { margin-left: 3%; }
pre {
border: 1px solid #ccc;
box-shadow: 3px 3px 3px #eee;
padding: 8pt;
font-family: monospace;
overflow: auto;
margin: 1.2em;
}
pre.src {
position: relative;
overflow: auto;
padding-top: 1.2em;
}
pre.src:before {
display: none;
position: absolute;
background-color: white;
top: -10px;
right: 10px;
padding: 3px;
border: 1px solid black;
}
pre.src:hover:before { display: inline;}
pre.src-sh:before    { content: 'sh'; }
pre.src-bash:before  { content: 'sh'; }
pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
pre.src-R:before     { content: 'R'; }
pre.src-perl:before  { content: 'Perl'; }
pre.src-java:before  { content: 'Java'; }
pre.src-sql:before   { content: 'SQL'; }
table { border-collapse:collapse; }
caption.t-above { caption-side: top; }
caption.t-bottom { caption-side: bottom; }
td, th { vertical-align:top;  }
th.right  { text-align: center;  }
th.left   { text-align: center;   }
th.center { text-align: center; }
td.right  { text-align: right;  }
td.left   { text-align: left;   }
td.center { text-align: center; }
dt { font-weight: bold; }
.footpara:nth-child(2) { display: inline; }
.footpara { display: block; }
.footdef  { margin-bottom: 1em; }
.figure { padding: 1em; }
.figure p { text-align: center; }
.inlinetask {
padding: 10px;
border: 2px solid gray;
margin: 10px;
background: #ffffcc;
}
#org-div-home-and-up
{ text-align: right; font-size: 70%; white-space: nowrap; }
textarea { overflow-x: auto; }
.linenr { font-size: smaller }
.code-highlighted { background-color: #ffff00; }
.org-info-js_info-navigation { border-style: none; }
#org-info-js_console-label
{ font-size: 10px; font-weight: bold; white-space: nowrap; }
.org-info-js_search-highlight
{ background-color: #ffff00; color: #000000; font-weight: bold; }
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">A catalog of Models in R</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org2b35f44">1. Simple Linear Model</a></li>
<li><a href="#org15ca40a">2. Multi-Linear Model</a></li>
<li><a href="#org23b00ad">3. Polynomial Model</a></li>
<li><a href="#org8f20c66">4. Exponential Model</a></li>
<li><a href="#org84b1eeb">5. Logistic Regression Model</a></li>
<li><a href="#orgac89500">6. K-nearest neighbourhood</a></li>
<li><a href="#orga3bf4e3">7. Bootstrap</a></li>
</ul>
</div>
</div>


<div id="outline-container-org2b35f44" class="outline-2">
<h2 id="org2b35f44"><span class="section-number-2">1</span> Simple Linear Model</h2>
<div class="outline-text-2" id="text-1">
\begin{equation}
Y = \beta_0 + \beta_1 X.
\end{equation}


<div class="org-src-container">
<pre class="src src-R">df <span style="color: #259ea2;">&lt;-</span> mtcars

my.lmodel <span style="color: #259ea2;">&lt;-</span> lm(mpg ~ wt, data=df)
summary(my.lmodel)
</pre>
</div>

<pre class="example">

Call:
lm(formula = mpg ~ wt, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5432 -2.3647 -0.1252  1.4096  6.8727 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***
wt           -5.3445     0.5591  -9.559 1.29e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.046 on 30 degrees of freedom
Multiple R-squared:  0.7528,	Adjusted R-squared:  0.7446 
F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10

</pre>
</div>
</div>

<div id="outline-container-org15ca40a" class="outline-2">
<h2 id="org15ca40a"><span class="section-number-2">2</span> Multi-Linear Model</h2>
<div class="outline-text-2" id="text-2">
\begin{equation}
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \ldots + \beta_n X_n.
\end{equation}


<div class="org-src-container">
<pre class="src src-R">df <span style="color: #259ea2;">&lt;-</span> mtcars

my.lmodel <span style="color: #259ea2;">&lt;-</span> lm(mpg ~ wt + hp, data=df)
summary(my.lmodel)
</pre>
</div>

<pre class="example">

Call:
lm(formula = mpg ~ wt + hp, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
wt          -3.87783    0.63273  -6.129 1.12e-06 ***
hp          -0.03177    0.00903  -3.519  0.00145 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.593 on 29 degrees of freedom
Multiple R-squared:  0.8268,	Adjusted R-squared:  0.8148 
F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12

</pre>
</div>
</div>




<div id="outline-container-org23b00ad" class="outline-2">
<h2 id="org23b00ad"><span class="section-number-2">3</span> Polynomial Model</h2>
<div class="outline-text-2" id="text-3">
\begin{equation}
Y = \beta_0 + \beta_1 X + \beta_2 X^2.
\end{equation}



<div class="org-src-container">
<pre class="src src-R">df <span style="color: #259ea2;">&lt;-</span>
data.frame(
<span style="color: #fa5151;">"XX"</span> = c(
9.692748, 8.694011, 2.711132, 2.363472, 5.529044, 7.009672, 6.399579, 3.828119,
7.728721, 9.178202, 8.685242, 8.782446, 1.168813, 8.417367),
<span style="color: #fa5151;">"YY"</span> = c(
-24.5773396,  -9.9371045,  66.9430825,  62.8107794,  36.1920856,  19.0341337,
 27.7069809,  45.1998159,  11.2022725, -15.5522627,  -6.5048885,  -6.7400534,
 68.0594333,  -3.1477693)
)

my.qmodel <span style="color: #259ea2;">&lt;-</span> lm(YY ~ XX + I(XX^2), data=df)
summary(my.qmodel)
</pre>
</div>

<pre class="example">

Call:
lm(formula = YY ~ XX + I(XX^2), data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.6322 -0.5881 -0.2455  1.3227  6.0064 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  71.8863     4.2283  17.001 3.03e-09 ***
XX           -1.7604     1.7851  -0.986 0.345255    
I(XX^2)      -0.8404     0.1577  -5.329 0.000241 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.305 on 11 degrees of freedom
Multiple R-squared:  0.9911,	Adjusted R-squared:  0.9895 
F-statistic: 611.4 on 2 and 11 DF,  p-value: 5.318e-12

</pre>
</div>
</div>


<div id="outline-container-org8f20c66" class="outline-2">
<h2 id="org8f20c66"><span class="section-number-2">4</span> Exponential Model</h2>
<div class="outline-text-2" id="text-4">
<p>
In order to fit the model
</p>
\begin{equation}
Y = \beta_0 e^{\beta_1 X},
\end{equation}

<p>
we take the logarithm and fit the linear model
</p>
\begin{equation}
\ln(Y) = \ln(\beta_0) + \beta_1 X.
\end{equation}

<div class="org-src-container">
<pre class="src src-R">df <span style="color: #259ea2;">&lt;-</span> data.frame(
<span style="color: #fa5151;">"XX"</span> = c(
    0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 ,
   10 , 11 , 12 , 13 , 14 , 15 , 16 ,
   17 , 18 , 19 , 20 , 21 , 22 , 23 ,
   24 , 25 , 26 , 27 , 28 , 29 , 30 ),
<span style="color: #fa5151;">"YY"</span> =  c(
125.0 ,100.7, 70.5 ,
83.4 , 100  , 65.9 , 66.5, 53.5 , 61.3 , 43.9 ,
42.2 , 45.7 , 32.5 , 36.6, 40.1 , 23.0 , 39.8 ,
20.8 , 35.0 , 17.9 , 21.1, 27.9 , 21.8 , 14.2 ,
13.6 , 11.8 , 25.1 , 8.19, 17.1 , 24.2 , 17.7 )
)

my.expmodel  <span style="color: #259ea2;">&lt;-</span>  lm(log(YY) ~ XX, data=df)
<span style="color: #008b45;"># </span><span style="color: #008b45;">plot(time, amount, pch=19, col="darkblue")</span>
<span style="color: #008b45;"># </span><span style="color: #008b45;">lines(time,exp(my.expfit$fitted.values),col="orange")</span>
summary(my.expmodel)
</pre>
</div>

<pre class="example">

Call:
lm(formula = log(YY) ~ XX, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.58725 -0.20024  0.02913  0.22138  0.63404 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.551145   0.101212   44.97  &lt; 2e-16 ***
XX          -0.068925   0.005795  -11.89 1.13e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2886 on 29 degrees of freedom
Multiple R-squared:  0.8299,	Adjusted R-squared:  0.824 
F-statistic: 141.4 on 1 and 29 DF,  p-value: 1.126e-12

</pre>
</div>
</div>


<div id="outline-container-org84b1eeb" class="outline-2">
<h2 id="org84b1eeb"><span class="section-number-2">5</span> Logistic Regression Model</h2>
<div class="outline-text-2" id="text-5">
<p>
We would like a model that predicts the relationship between \(Pr(Y=1|X)\) and \(X\).
</p>

<p>
The logistic function \(p:\mathbb{R}\to [0,1]\) is given by
</p>
\begin{equation}
p(X) = \frac{ e^{\beta_0 + \beta_1 X}}{1 + e^{\beta_0 + \beta_1 X}}.
\end{equation}


<p>
The <i>odds</i> are given by
</p>
\begin{equation}
\frac{p(X)}{1-p(X)},
\end{equation}

<p>
its logarithm is called <i>log-odds</i> or simply <i>logit</i>:
</p>
\begin{equation}
\ln\left(\frac{p(X)}{1-p(X)}\right).
\end{equation}


<p>
Then, the <i>logistic</i> regression model has a <i>linear</i> logit in the variable \(X\).
</p>


<div class="org-src-container">
<pre class="src src-R"><span style="color: #259ea2;">library</span>(ISLR)
<span style="color: #008b45;"># </span><span style="color: #008b45;">Default data set:</span>
     <span style="color: #008b45;"># </span><span style="color: #008b45;">A simulated data set containing information on ten thousand</span>
     <span style="color: #008b45;"># </span><span style="color: #008b45;">customers. The aim here is to predict which customers will default</span>
     <span style="color: #008b45;"># </span><span style="color: #008b45;">on their credit card debt.</span>
df <span style="color: #259ea2;">&lt;-</span> Default

df$Y  <span style="color: #259ea2;">&lt;-</span>  ifelse(df$default<span style="color: #259ea2;">%in%</span><span style="color: #fa5151;">"Yes"</span>,1,0) <span style="color: #008b45;">## </span><span style="color: #008b45;">Encoding Yes as 1 and No as 0.</span>

my.logisticmodel <span style="color: #259ea2;">&lt;-</span>glm(Y ~ balance, data=df,family=<span style="color: #fa5151;">"binomial"</span>)

summary(my.logisticmodel)
</pre>
</div>

<pre class="example">

Call:
glm(formula = Y ~ balance, family = "binomial", data = df)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2697  -0.1465  -0.0589  -0.0221   3.7589  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.065e+01  3.612e-01  -29.49   &lt;2e-16 ***
balance      5.499e-03  2.204e-04   24.95   &lt;2e-16 ***
---
codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1596.5  on 9998  degrees of freedom
AIC: 1600.5

Number of Fisher Scoring iterations: 8
</pre>


<p>
To add the estimated probabilities \(p(X)\) and predicting a class with
threshold \(p(X) > 0.5\).
</p>

<div class="org-src-container">
<pre class="src src-R">p1 <span style="color: #259ea2;">&lt;-</span> predict(my.logisticmodel,df, type=<span style="color: #fa5151;">"response"</span>)
df <span style="color: #259ea2;">&lt;-</span> cbind(df,p1)
df$class <span style="color: #259ea2;">&lt;-</span> ifelse(df$p1&gt;0.5,<span style="color: #fa5151;">"Yes"</span>,<span style="color: #fa5151;">"No"</span>)
</pre>
</div>

<p>
The confusion matrix 
</p>

<div class="org-src-container">
<pre class="src src-R">CC <span style="color: #259ea2;">&lt;-</span> table(df$default,df$class)
<span style="color: #008b45;"># </span><span style="color: #008b45;">Confusion matrix:</span>
CC
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">No</th>
<th scope="col" class="org-right">Yes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">9625</td>
<td class="org-right">42</td>
</tr>

<tr>
<td class="org-right">233</td>
<td class="org-right">100</td>
</tr>
</tbody>
</table>


<p>
and the accuracy of the classification
</p>
<div class="org-src-container">
<pre class="src src-R"><span style="color: #008b45;">#</span><span style="color: #008b45;">accuracy</span>
sum(diag(CC)) / sum(CC)
</pre>
</div>

<pre class="example">

[1] 0.9725
</pre>
</div>
</div>

<div id="outline-container-orgac89500" class="outline-2">
<h2 id="orgac89500"><span class="section-number-2">6</span> K-nearest neighbourhood</h2>
<div class="outline-text-2" id="text-6">
<p>
<b>The Normalisation function</b> Since
Different variables have different scaling units, like weight in kg
and height in cm. We normalise each one of the variables and therefore each variable 
will be represented by a value between \(0\) and \(1\).
</p>

\begin{equation}
N(X_1) = \frac{ X - \min(\{X_1, \ldots,X_n\}) } {\max(\{X_1, \ldots,X_n\}) - \min(\{X_1, \ldots,X_n\})}.
\end{equation}


<div class="org-src-container">
<pre class="src src-R"><span style="color: #008b45;">## </span><span style="color: #008b45;">We will be working with the iris data set.</span>
df <span style="color: #259ea2;">&lt;-</span> iris

<span style="color: #2c53ca;">nor</span> <span style="color: #259ea2;">&lt;-</span><span style="color: #2020cc; font-weight: bold;">function</span>(x) { (x -min(x))/(max(x)-min(x))   }

<span style="color: #008b45;">## </span><span style="color: #008b45;">Run nomalization on first 4 coulumns which</span>
<span style="color: #008b45;">## </span><span style="color: #008b45;">are the predictors.</span>
<span style="color: #008b45;">## </span><span style="color: #008b45;">Note the use of the lapply function</span>

df_norm <span style="color: #259ea2;">&lt;-</span> as.data.frame(lapply(df[,c(1:4)], nor))

<span style="color: #008b45;">##</span><span style="color: #008b45;">extract testing set consisting of a </span>
<span style="color: #008b45;">## </span><span style="color: #008b45;">subset of 90% of the rows</span>

ran <span style="color: #259ea2;">&lt;-</span> sample(1:nrow(df), 0.9 * nrow(df)) 
df_train <span style="color: #259ea2;">&lt;-</span> df_norm[ran,] 
df_train_category <span style="color: #259ea2;">&lt;-</span> df[ran,5] 


df_test <span style="color: #259ea2;">&lt;-</span> df_norm[-ran,]  
df_test_category <span style="color: #259ea2;">&lt;-</span> df[-ran,5]

 <span style="color: #259ea2;">library</span>(class) 
<span style="color: #008b45;">##</span><span style="color: #008b45;">run knn function</span>
 pr <span style="color: #259ea2;">&lt;-</span> knn(df_train,df_test,cl=df_train_category,k=5)

 <span style="color: #008b45;">##</span><span style="color: #008b45;">create confusion matrix</span>
CC <span style="color: #259ea2;">&lt;-</span> table(pr,df_test_category)

<span style="color: #008b45;">## </span><span style="color: #008b45;">accuracy is the ratio of  correct predictions </span>
<span style="color: #008b45;">## </span><span style="color: #008b45;">by total number of predictions </span>

sum(diag(CC))/sum(CC) * 100

</pre>
</div>

<pre class="example">
86.6666666666667
</pre>




<p>
<b>Remark</b>.Note that result may be different each time we run the code,
 because we are using a random selection.
</p>
</div>
</div>





<div id="outline-container-orga3bf4e3" class="outline-2">
<h2 id="orga3bf4e3"><span class="section-number-2">7</span> Bootstrap</h2>
<div class="outline-text-2" id="text-7">
<p>
In this example in particular we will use the Bootstrap method in order to estimate the variance (standard deviation)
of the following function depending on two variables \(X\) and \(Y\) given by:
</p>


\begin{equation}
\label{eq:01}
\alpha = \frac{\sigma^2_{Y} - \sigma_{XY}}{\sigma_{X}^2 + \sigma_{Y}^2 - 2\sigma_{XY}}.
\end{equation}


<div class="org-src-container">
<pre class="src src-R"><span style="color: #259ea2;">library</span>(boot)
<span style="color: #259ea2;">library</span>(ISLR)

df <span style="color: #259ea2;">&lt;-</span> Portfolio

<span style="color: #2c53ca;">my.function</span> <span style="color: #259ea2;">&lt;-</span> <span style="color: #2020cc; font-weight: bold;">function</span>(data, index){
                      X <span style="color: #259ea2;">&lt;-</span> data[index,<span style="color: #fa5151;">"X"</span>]
                      Y <span style="color: #259ea2;">&lt;-</span> data[index,<span style="color: #fa5151;">"Y"</span>]
                      <span style="color: #2020cc; font-weight: bold;">return</span>(
                              ( var(Y) - cov(X,Y) ) /
                              ( var(X) + var(Y) - 2*cov(X,Y))
                     )
}
boot.result <span style="color: #259ea2;">&lt;-</span> boot(data=df,my.function,R=1000)
boot.result
</pre>
</div>

<pre class="example">

ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = df, statistic = my.function, R = 1000)


Bootstrap Statistics :
     original      bias    std. error
t1* 0.5758321 0.004756099  0.09076746
</pre>


<p>
Of course, the function can be anything else but the implementation is similar.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-01-26 Wed 00:00</p>
<p class="author">Author: daniel b</p>
<p class="date">Created: 2022-02-02 Wed 21:14</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
